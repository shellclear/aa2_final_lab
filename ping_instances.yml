---
- import_playbook: in_memory_inventory.yml

- name: Check If OSP instances are running
  hosts:
    - load_balancers
    - app_servers
    - database_servers
  gather_facts: no
  become: no
  tags:
    - ping_instances

  tasks:
    - name: Wait 300 seconds, but only start checking after 60 seconds
      wait_for_connection:
        delay: 15
        timeout: 300

    - name: Ping instances
      ansible.builtin.ping:
      register: pong
      retries: 3

    - name: DEBUG Ping instances
      debug:
        msg: "{{ pong }}"
        
        